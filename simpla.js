!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define("Simpla",n):e.Simpla=n()}(this,function(){"use strict";function e(e,n){return n={exports:{}},e(n,n.exports,_),n.exports}function n(){B=!1,L.length?C=L.concat(C):J=-1,C.length&&t()}function t(){if(!B){var e=setTimeout(n);B=!0;for(var t=C.length;t;){for(L=C,C=[];++J<t;)L&&L[J].run();J=-1,t=C.length}L=null,B=!1,clearTimeout(e)}}function o(e){var n=new Array(arguments.length-1);if(arguments.length>1)for(var o=1;o<arguments.length;o++)n[o-1]=arguments[o];C.push(new r(e,n)),1!==C.length||B||setTimeout(t,0)}function r(e,n){this.fun=e,this.array=n}function i(){}function u(e){throw new Error("process.binding is not supported")}function f(){return"/"}function c(e){throw new Error("process.chdir is not supported")}function a(){return 0}function s(e){var n=.001*oe.call(te),t=Math.floor(n),o=Math.floor(n%1*1e9);return e&&(t-=e[0],o-=e[1],o<0&&(t--,o+=1e9)),[t,o]}function p(){var e=new Date,n=e-re;return n/1e3}function l(e){return ue(Object(e))}function d(e){var n=!1;if(null!=e&&"function"!=typeof e.toString)try{n=!!(e+"")}catch(t){}return n}function y(e){return!!e&&"object"==("undefined"==typeof e?"undefined":z["typeof"](e))}function h(e){if(!y(e)||le.call(e)!=fe||d(e))return!1;var n=l(e);if(null===n)return!0;var t=se.call(n,"constructor")&&n.constructor;return"function"==typeof t&&t instanceof t&&ae.call(t)==pe}function m(e,n,t){function o(){d===l&&(d=l.slice())}function r(){return p}function i(e){if("function"!=typeof e)throw new Error("Expected listener to be a function.");var n=!0;return o(),d.push(e),function(){if(n){n=!1,o();var t=d.indexOf(e);d.splice(t,1)}}}function u(e){if(!h(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if("undefined"==typeof e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(y)throw new Error("Reducers may not dispatch actions.");try{y=!0,p=s(p,e)}finally{y=!1}for(var n=l=d,t=0;t<n.length;t++)n[t]();return e}function f(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");s=e,u({type:be.INIT})}function c(){var e,n=i;return e={subscribe:function(e){function t(){e.next&&e.next(r())}if("object"!==("undefined"==typeof e?"undefined":z["typeof"](e)))throw new TypeError("Expected the observer to be an object.");t();var o=n(t);return{unsubscribe:o}}},e[me]=function(){return this},e}var a;if("function"==typeof n&&"undefined"==typeof t&&(t=n,n=void 0),"undefined"!=typeof t){if("function"!=typeof t)throw new Error("Expected the enhancer to be a function.");return t(m)(e,n)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var s=e,p=n,l=[],d=l,y=!1;return u({type:be.INIT}),a={dispatch:u,subscribe:i,getState:r,replaceReducer:f},a[me]=c,a}function b(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e);try{throw new Error(e)}catch(n){}}function w(){}function v(e){return{type:Ee,prop:"authEndpoint",value:e}}function g(e){return{type:Ee,prop:"dataEndpoint",value:e}}function E(e){return{type:we,href:e}}function j(e,n){return{type:ge,href:e}}function x(e){return{type:ve,href:e}}function O(e){return function(n,t){var o=t(),r=o.imports,i=void 0;if(i=document.createElement("link"),i.href=e,i.rel="import",i.async=!0,!r[i.href]||"failed"===r[i.href].status)return n(E(i.href)),new Promise(function(e,n){i.onload=e,i.onerror=n,document.head.appendChild(i)}).then(function(){return n(x(i.href))},function(){return n(j(i.href))})}}function S(e){return e.ok?e:new Promise(function(n,t){var o=e.body,r="";o.on("data",function(e){return r+=e.toString()}),o.on("error",t),o.on("end",function(){var n=new Error(r);try{n=JSON.parse(r)}catch(o){n.code=e.status}n.response=e,t(n)})})}function N(e){var n=Object.assign({},e);return n.headers=Object.assign({Accept:"application/json"},n.headers),e.body&&(n.body=JSON.stringify(e.body)),fetch(e.url,n).then(S).then(function(e){return e.json()})}function T(e){var n=e.email,t=e.password;return{type:je,email:n,password:t}}function A(e){return{type:xe,token:e}}function k(e){return{type:Oe,error:e}}function P(e){var n=e.email,t=e.password;return function(e,o){var r=o().options.authEndpoint;return e(T({email:n,password:t})),Ne.post(r+"/login",{email:n,password:t}).then(function(n){return e(A(n.token))},function(n){return e(k(n))})}}function I(){return{type:Se}}function D(){return function(e){return e(I()),Promise.resolve()}}var _="undefined"!=typeof window?window:"undefined"!=typeof global?global:this,z={};z["typeof"]="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},z.defineProperty=function(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e},z.toConsumableArray=function(e){if(Array.isArray(e)){for(var n=0,t=Array(e.length);n<e.length;n++)t[n]=e[n];return t}return Array.from(e)};var L,R="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},C=[],B=!1,J=-1;r.prototype.run=function(){this.fun.apply(null,this.array)};var M="browser",V="browser",Y=!0,q={},F=[],G="",H={},U={},K={},Q=i,W=i,X=i,Z=i,$=i,ee=i,ne=i,te=R.performance||{},oe=te.now||te.mozNow||te.msNow||te.oNow||te.webkitNow||function(){return(new Date).getTime()},re=new Date,ie={nextTick:o,title:M,browser:Y,env:q,argv:F,version:G,versions:H,on:Q,addListener:W,once:X,off:Z,removeListener:$,removeAllListeners:ee,emit:ne,binding:u,cwd:f,chdir:c,umask:a,hrtime:s,platform:V,release:U,config:K,uptime:p},ue=Object.getPrototypeOf,fe="[object Object]",ce=Object.prototype,ae=Function.prototype.toString,se=ce.hasOwnProperty,pe=ae.call(Object),le=ce.toString,de=e(function(e){e.exports=function(e){var n,t=e.Symbol;return"function"==typeof t?t.observable?n=t.observable:(n=t("observable"),t.observable=n):n="@@observable",n}}),ye=de&&"object"===("undefined"==typeof de?"undefined":z["typeof"](de))&&"default"in de?de["default"]:de,he=e(function(e,n,t){e.exports=ye(t||window||_)}),me=he&&"object"===("undefined"==typeof he?"undefined":z["typeof"](he))&&"default"in he?he["default"]:he,be={INIT:"@@redux/INIT"};"production"!==ie.env.NODE_ENV&&"string"==typeof w.name&&"isCrushed"!==w.name&&b("You are currently using minified code outside of NODE_ENV === 'production'. This means that you are running a slower development build of Redux. You can use loose-envify (https://github.com/zertosh/loose-envify) for browserify or DefinePlugin for webpack (http://stackoverflow.com/questions/30030031) to ensure you have the correct code for your production build.");var we="import-element",ve="import-element-success",ge="import-element-failed",Ee="set-option",je="login",xe="login-successful",Oe="login-failed",Se="logout",Ne={get:function(e){return N({url:e,method:"GET"})},post:function(e,n,t){return N({url:e,method:"POST",headers:{Authorization:"Bearer "+t}})},"delete":function(e,n){return N({url:e,method:"DELETE",headers:{Authorization:"Bearer "+n}})}},Te="https://api.simpla.io",Ae="https://elements.simpla.io",ke=["simpla-img/simpla-img.html","simpla-text/simpla-text.html","simpla-block/simpla-block.html","sm-admin/sm-admin.html"],Pe=Ae+"/",Ie=function(e,n){return e},De=m(Ie),_e=function ze(e){ze._store=ze._store||De;var n=void 0,t="",o=void 0,r=void 0,i=[];o=Te,ze._store.dispatch(v(o)),n="string"==typeof e?e:e.project,r=Te+"/projects/"+n+"/items",ze._store.dispatch(g(r)),"undefined"==typeof e.elements?(i=ke,t=Pe):e.elements instanceof Array?i=e.elements:e.elements&&(i=e.elements.paths||ke,t=e.elements.base||Pe),i.forEach(function(e){return ze._store.dispatch(O(""+t+e))})};return Object.assign(_e,{login:function(){return De.dispatch(P.apply(void 0,arguments))},logout:function(){return De.dispatch(D.apply(void 0,arguments))}}),_e});