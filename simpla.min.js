!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Simpla",t):e.Simpla=t()}(this,function(){"use strict";function e(){throw new Error("setTimeout has not been defined")}function t(){throw new Error("clearTimeout has not been defined")}function n(t){if($e===setTimeout)return setTimeout(t,0);if(($e===e||!$e)&&setTimeout)return $e=setTimeout,setTimeout(t,0);try{return $e(t,0)}catch(n){try{return $e.call(null,t,0)}catch(n){return $e.call(this,t,0)}}}function r(e){if(Qe===clearTimeout)return clearTimeout(e);if((Qe===t||!Qe)&&clearTimeout)return Qe=clearTimeout,clearTimeout(e);try{return Qe(e)}catch(n){try{return Qe.call(null,e)}catch(n){return Qe.call(this,e)}}}function o(){et&&Ve&&(et=!1,Ve.length?Ze=Ve.concat(Ze):tt=-1,Ze.length&&i())}function i(){if(!et){var e=n(o);et=!0;for(var t=Ze.length;t;){for(Ve=Ze,Ze=[];++tt<t;)Ve&&Ve[tt].run();tt=-1,t=Ze.length}Ve=null,et=!1,r(e)}}function u(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];Ze.push(new a(e,t)),1!==Ze.length||et||n(i)}function a(e,t){this.fun=e,this.array=t}function c(){}function s(e){throw new Error("process.binding is not supported")}function f(){return"/"}function l(e){throw new Error("process.chdir is not supported")}function d(){return 0}function p(e){var t=.001*wt.call(bt),n=Math.floor(t),r=Math.floor(t%1*1e9);return e&&(n-=e[0],r-=e[1],r<0&&(n--,r+=1e9)),[n,r]}function v(){var e=new Date,t=e-_t;return t/1e3}function h(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function y(e,t){return t={exports:{}},e(t,t.exports),t.exports}function m(e){var t=Ut.call(e,Lt),n=e[Lt];try{e[Lt]=void 0;var r=!0}catch(o){}var i=Dt.call(e);return r&&(t?e[Lt]=n:delete e[Lt]),i}function g(e){return Ft.call(e)}function b(e){return null==e?void 0===e?Xt:Ht:zt&&zt in Object(e)?m(e):g(e)}function w(e,t){return function(n){return e(t(n))}}function _(e){return null!=e&&"object"==("undefined"==typeof e?"undefined":St(e))}function j(e){if(!_(e)||b(e)!=Yt)return!1;var t=Bt(e);if(null===t)return!0;var n=$t.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Wt.call(n)==Qt}function O(e){var t,n=e.Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}function S(e,t,n){function r(){p===d&&(p=d.slice())}function o(){return l}function i(e){if("function"!=typeof e)throw new Error("Expected listener to be a function.");var t=!0;return r(),p.push(e),function(){if(t){t=!1,r();var n=p.indexOf(e);p.splice(n,1)}}}function u(e){if(!j(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if("undefined"==typeof e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(v)throw new Error("Reducers may not dispatch actions.");try{v=!0,l=f(l,e)}finally{v=!1}for(var t=d=p,n=0;n<t.length;n++)t[n]();return e}function a(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");f=e,u({type:Zt.INIT})}function c(){var e,t=i;return e={subscribe:function(e){function n(){e.next&&e.next(o())}if("object"!==("undefined"==typeof e?"undefined":St(e)))throw new TypeError("Expected the observer to be an object.");n();var r=t(n);return{unsubscribe:r}}},e[Vt]=function(){return this},e}var s;if("function"==typeof t&&"undefined"==typeof n&&(n=t,t=void 0),"undefined"!=typeof n){if("function"!=typeof n)throw new Error("Expected the enhancer to be a function.");return n(S)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var f=e,l=t,d=[],p=d,v=!1;return u({type:Zt.INIT}),s={dispatch:u,subscribe:i,getState:o,replaceReducer:a},s[Vt]=c,s}function T(e,t){var n=t&&t.type,r=n&&'"'+n.toString()+'"'||"an action";return"Given action "+r+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state.'}function E(e){Object.keys(e).forEach(function(t){var n=e[t],r=n(void 0,{type:Zt.INIT});if("undefined"==typeof r)throw new Error('Reducer "'+t+'" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined.');var o="@@redux/PROBE_UNKNOWN_ACTION_"+Math.random().toString(36).substring(7).split("").join(".");if("undefined"==typeof n(void 0,{type:o}))throw new Error('Reducer "'+t+'" returned undefined when probed with a random type. '+("Don't try to handle "+Zt.INIT+' or other actions in "redux/*" ')+"namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined.")})}function A(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var o=t[r];"function"==typeof e[o]&&(n[o]=e[o])}var i,u=Object.keys(n);try{E(n)}catch(a){i=a}return function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=arguments[1];if(i)throw i;for(var r=!1,o={},a=0;a<u.length;a++){var c=u[a],s=n[c],f=e[c],l=s(f,t);if("undefined"==typeof l){var d=T(c,t);throw new Error(d)}o[c]=l,r=r||l!==f}return r?o:e}}function P(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0===t.length)return function(e){return e};if(1===t.length)return t[0];var r=t[t.length-1],o=t.slice(0,-1);return function(){return o.reduceRight(function(e,t){return t(e)},r.apply(void 0,arguments))}}function k(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(n,r,o){var i=e(n,r,o),u=i.dispatch,a=[],c={getState:i.getState,dispatch:function(e){return u(e)}};return a=t.map(function(e){return e(c)}),u=P.apply(void 0,a)(i.dispatch),en({},i,{dispatch:u})}}}function x(e,t){return{type:tn,prop:e,value:t}}function q(){return{type:In}}function I(){return{type:Nn}}function N(e){return e.ok?e:Promise.resolve().then(function(){return e.json()}).then(function(t){return t.code=t.code||e.status,t.statusText=t.statusText||e.statusText,Promise.reject(t)})}function C(e){var t=Pt({},e);return t.headers=Pt({Accept:"application/json"},t.headers),e.body&&(t.body=JSON.stringify(e.body),t.headers=Pt({"Content-Type":"application/json"},t.headers)),Rn(e.url,t).then(N).then(function(e){return 204===e.status?null:e.json()})}function R(e){var t=e.token;return t&&(e.headers=Pt({Authorization:"Bearer "+t},e.headers)),C(e)}function M(e){var t=e.email,n=e.password;return{type:nn,email:t,password:n}}function U(e){return{type:rn,response:e}}function D(e){return{type:on,response:e}}function L(e){var t=e.email,n=e.password;return function(e,r){var o=r().config.authEndpoint;return e(M({email:t,password:n})),Mn.post(o+"/login",{body:{email:t,password:n}}).then(function(t){return e(U(t.token))},function(t){return e(D(t))})}}function J(){return{type:un}}function F(){return{type:an}}function H(){return function(e){return e(J()),Promise.resolve().then(function(){return e(F())})}}function X(e,t){var n=void 0,r=void 0;return"undefined"==typeof t?t:"string"==typeof e?X(e.split("."),t):(n=e[0],r=parseInt(n),isNaN(r)||(n=r),0===e.length?t:X(e.slice(1),t[n]))}function z(e,t){var n=t[Dn],r=void 0;return n&&(r=n.content[e]),r}function B(e,t){var n=t[Dn].content;return{items:e.map(function(e){return n[e]})}}function Y(e,t){var n=t[Dn],r=[],o=void 0,i=void 0;if(!n)return{items:[]};if(o=n.content,i=n.hierarchy,e.parent){var u=X(e.parent,i);u&&(r=Object.keys(u).map(function(t){return e.parent+"."+t}))}else r=Object.keys(o);return B(r,t)}function G(e){return{observe:function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var o=n.pop(),i=n[0],u=void 0,a=void 0,c=void 0;return a=function(){return i?X(i,e.getState()):e.getState()},u=a(),c=function(){var e=a();if(e!==u){var t=[e,u];u=e,o.apply(void 0,t)}},{unobserve:e.subscribe(c)}}}}function K(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];return"undefined"!=typeof t&&null!==t&&(e.parent?t.id!==e.parent&&0===t.id.indexOf(e.parent):0===Object.keys(e).length)}function W(e){return function(t){return t.type===e?Promise.resolve(t):Promise.reject(t)}}function $(e,t,n){var r=function(e){return"undefined"!=typeof e.type&&"undefined"!=typeof e.response};return e(t).then(W(n)).then(function(e){return e.response},function(e){return r(e)?Promise.reject(e.response):Promise.reject(e)})}function Q(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return $.apply(void 0,[e.dispatch].concat(n))}function V(e){return JSON.parse(JSON.stringify(e))}function Z(e){var t=["type","data"],n=Object.keys(e||{});return 0!==n.length&&n.every(function(e){return t.indexOf(e)!==-1})}function ee(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=function(e,t){return e<t?-1:e>t?1:0};return Object.keys(e).sort(t).reduce(function(t,n){var r=e[n],o=void 0;return o=t?t+"&":"?",""+o+n+"="+encodeURIComponent(r)},"")}function te(e,t){var n=t[Ln],r=ee(e);return!!(n&&n[r]&&n[r].queriedRemote)}function ne(){return{type:null,data:null}}function re(e,t){return null===t?null:Pt(V(t),{id:e})}function oe(e){return e?(e=e.replace(/^\/+/,"").replace(/\/+$/,""),e.split("/").join(".")):e}function ie(e){return e?("."!==e.charAt(0)&&(e="."+e),e.split(".").join("/")):e}function ue(e){var t=void 0,n=void 0;return e?(t=ie(e.id),n=Pt({},e,{path:t}),delete n.id,n):e}function ae(e){var t=void 0;return e?(t=e.items.map(ue),Pt({},e,{items:t})):e}function ce(e){if("/"!==e.charAt(0))throw new Error("Invalid path "+e+". Path must be a string starting with '/'");if(e.indexOf("//")!==-1)throw new Error("Invalid path '"+e+"'. Paths must not have more than one '/' in a row.")}function se(e){if("undefined"!=typeof e&&""===e)return"Invalid UID: Empty string is not a valid UID"}function fe(e){var t=e.uid,n=void 0===t?"":t,r=e.validateUid,o=void 0===r||r,i=e.query,u=e.endpoint,a=e.token,c=e.method,s=e.body,f=u+"/"+encodeURIComponent(n)+ee(i),l=se(n);return o&&l?Promise.reject(new Error(l)):Mn[c](f,{body:s,token:a})}function le(e,t,n,r){var o=kt(n,3),i=o[0],u=o[1],a=o[2];return function(){for(var n=arguments.length,o=Array(n),c=0;c<n;c++)o[c]=arguments[c];return function(n,c){var s=c(),f=s.config,l=s.token,d=f.dataEndpoint,p=void 0;return p=Pt({method:e,endpoint:d,token:l,validateUid:r},t.apply(void 0,o)),n(i.apply(void 0,o)),fe(p).then(function(e){return n(u.apply(void 0,o.concat([e])))},function(e){return n(a.apply(void 0,o.concat([e])))})}}}function de(e){return{type:ln,query:e}}function pe(e,t){return{type:dn,query:e,response:t}}function ve(e){return{type:pn,uid:e}}function he(e,t){return{type:vn,response:t,uid:e}}function ye(e,t){return{type:hn,uid:e,data:t}}function me(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n=Pt({persist:!0},n);var r=n,o=r.persist;return{type:yn,response:re(e,t),uid:e,persist:o}}function ge(e,t){return{type:mn,response:t,uid:e}}function be(e){return{type:gn,uid:e}}function we(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t=Pt({persist:!0},t);var n=t,r=n.persist;return{type:bn,uid:e,persist:r}}function _e(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n=Pt({validate:!0,createAncestry:!0,persist:!0},n);var r=n,o=r.validate,i=r.createAncestry,u=r.persist;return function(n,r){function a(e){var t=e.split(".").slice(0,-1).join(".");return!t||z(t,r())?Promise.resolve():$(n,_e(t,ne(t),{persist:!1}),yn)}var c=void 0;if(n(ye(e,t)),o&&!Z(t))c=ge(e,new Error(Un));else{var s=z(e,r());t=Pt({},s,t),c=me(e,t,{persist:u})}return(i?a(e):Promise.resolve()).then(function(){return n(c)})}}function je(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t=Pt({persist:!0},t);var n=t,r=n.persist;return function(t,n){function o(e){if(!e)return Promise.resolve();var r=Y({parent:e},n()),o=r.items,i=function(e){return $(t,je(e.id,{persist:!1}),bn)};return Promise.all(o.map(i))}return t(be(e)),o(e).then(function(){return t(we(e,{persist:r}))})}}function Oe(e){return function(t,n){var r=void 0,o=void 0,i=void 0;return t(ve(e)),r=n(),o=z(e,r),i="undefined"==typeof o?$(t,Vn(e),Sn).then(function(n){return $(t,_e(e,n,{validate:!1,createAncestry:!1}),yn)}):Promise.resolve(o),i.then(function(n){return t(he(e,n))})}}function Se(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,n){var r=void 0,o=void 0,i=void 0;return t(de(e)),o=function(e){return $(t,_e(e.id,e,{validate:!1}),yn)},r=function(e){var t=n(),r=function(e){var n=e.id;return"undefined"==typeof z(n,t)};return Promise.all(e.items.filter(r).map(o))},i=function(){return Promise.resolve().then(function(){return Y(e,n())}).then(function(n){return t(pe(e,n))})},te(e,n())?i():$(t,tr(e),_n).then(r).then(i)}}function Te(e){return{type:Cn,query:e}}function Ee(){return{type:cn}}function Ae(){return{type:sn}}function Pe(){return{type:fn}}function ke(){return function(e,t){var n=void 0,r=void 0,o=void 0,i=void 0,u=void 0;e(Ee());var a=t().save,c=Object.keys(a).map(function(e){return[e,a[e]]});return r=function(e){var t=kt(e,2),n=t[1],r=n.local,o=n.changed;return null===r&&o},o=function(e){var t=kt(e,2),n=t[1],r=n.local,o=n.changed;return null!==r&&o},n=function(t){return $(e,_e(t.id,t,{validate:!1}),yn)},i=c.filter(o).map(function(e){var t=kt(e,2),n=t[0],r=t[1].local;return Zn(n,r)}).map(function(t){return $(e,t,An).then(n)}),u=c.filter(r).map(function(e){var t=kt(e,1),n=t[0];return er(n)}).map(function(t){return $(e,t,xn)}),Promise.all([].concat(xt(i),xt(u))).then(function(){return e(Ae())},function(){return e(Pe())})}}function xe(){window.Polymer=window.Polymer||{dom:"shadow"}}function qe(e){var t=(new Date).getTime()/1e3,n=void 0;if(!e)return!1;try{var r=e.split("."),o=kt(r,2),i=o[1];n=JSON.parse(atob(i))}catch(u){return console.warn(sr,u.message),!1}return!(n.exp&&t>n.exp)&&!(!n.iss||n.iss!==ir)}function Ie(e){if(e)try{window.localStorage.setItem(or,e)}catch(t){console.warn(ur)}else try{window.localStorage.removeItem(or)}catch(t){console.warn(cr)}}function Ne(e){var t=void 0;try{t=window.localStorage.getItem(or)}catch(n){t=!1,console.log(ar)}if(qe(t))e._store.dispatch(U(t));else try{window.localStorage.removeItem(or)}catch(n){console.warn(cr)}}function Ce(e){return function(t){var n=t.dispatch,r=t.getState;return function(t){return function(o){return"function"==typeof o?o(n,r,e):t(o)}}}}function Re(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments[1];switch(t.type){case rn:return!0;case an:return!1;default:return e}}function Me(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case tn:return Pt({},e,At({},t.prop,t.value));default:return e}}function Ue(e,t,n){return Pt({},e,At({},t,Pt({},e[t],n)))}function De(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=void 0;switch(t.type){case ln:return n=ee(t.query),e[n]?e[n].querying?e:Ue(e,n,{querying:!0}):Ue(e,n,{query:t.query,querying:!0,queriedRemote:!1,cache:[],matches:[]});case dn:if(n=ee(t.query),0!==e[n].cache.length){var r=e[n],o=r.matches,i=r.cache,u=void 0;if(u=[].concat(xt(o),xt(i.filter(pr(o)))),u.length!==o.length)return Ue(e,n,{querying:!1,cache:[],matches:u})}return Ue(e,n,{cache:[],querying:!1});case _n:return n=ee(t.query),e[n].queriedRemote?e:Ue(e,n,{queriedRemote:!0});case Cn:return n=ee(t.query),e[n]?e:Ue(e,n,{query:t.query,querying:!1,queriedRemote:!1,cache:[],matches:[]});case yn:return Object.keys(e).reduce(function(e,n){var r=e[n],o=r.query,i=r.matches,u=r.cache,a=r.querying,c=t.response,s=t.uid,f=a?u:i,l=void 0;return l=K(o,c)?[].concat(xt(f),[s]):f.filter(vr(s)),l.length!==f.length?Ue(e,n,At({},a?"cache":"matches",l)):e},e);case bn:return Object.keys(e).reduce(function(e,n){var r=e[n].matches,o=t.uid,i=void 0;return i=r.filter(vr(o)),i!==r.length?Ue(e,n,{matches:i}):e},e);default:return e}}function Le(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:hr,t=arguments[1];switch(t.type){case In:return!0;case Nn:return!1;default:return e}}function Je(e,t){return JSON.stringify(e)===JSON.stringify(t)}function Fe(e,t){var n=t[0],r=1===t.length?{}:Fe(e[n]||{},t.slice(1));return Pt({},e,At({},n,r))}function He(e,t){var n=t[0];if(1===t.length){var r=Pt({},e);return delete r[n],r}return e.hasOwnProperty(n)?Pt({},e,At({},n,He(e[n],t.slice(1)))):e}function Xe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case yn:return Fe(e,t.uid.split("."),{});case bn:return He(e,t.uid.split("."));default:return e}}function ze(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case yn:var n=e[t.uid],r=V(t.response);return Je(n,r)?e:Pt({},e,At({},t.uid,V(t.response)));case bn:return null===e[t.uid]?e:Pt({},e,At({},t.uid,null));default:return e}}function Be(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case rn:return t.response;case un:return null;default:return e}}function Ye(e,t){var n=JSON.stringify(e),r=JSON.stringify(t);return n!==r}function Ge(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=arguments[2],r=e.local,o=e.remote,i=e.changed;return n?o=V(t||null):r=V(t||null),i=Ye(o,r),Pt({},e,{local:r,remote:o,changed:i})}function Ke(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=void 0,r=void 0,o=void 0;switch(n=function(t){return function(n,r,o){var i=n[r],u=Ge(n[r],o,t);return i===u?e:Pt({},n,At({},r,u))}},r=n(!1),o=n(!0),t.type){case _n:return t.response.items.reduce(function(e,t){return o(e,t.id,t)},e);case Sn:case An:return o(e,t.uid,t.response);case xn:return o(e,t.uid,null);case yn:return t.persist?r(e,t.uid,t.response):e;case bn:if(!t.persist){var i=Pt({},e);return delete i[t.uid],i}return r(e,t.uid,t.response);default:return e}}var We="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},$e=e,Qe=t;"function"==typeof We.setTimeout&&($e=setTimeout),"function"==typeof We.clearTimeout&&(Qe=clearTimeout);var Ve,Ze=[],et=!1,tt=-1;a.prototype.run=function(){this.fun.apply(null,this.array)};var nt,rt="browser",ot="browser",it=!0,ut={},at=[],ct="",st={},ft={},lt={},dt=c,pt=c,vt=c,ht=c,yt=c,mt=c,gt=c,bt=We.performance||{},wt=bt.now||bt.mozNow||bt.msNow||bt.oNow||bt.webkitNow||function(){return(new Date).getTime()},_t=new Date,jt={nextTick:u,title:rt,browser:it,env:ut,argv:at,version:ct,versions:st,on:dt,addListener:pt,once:vt,off:ht,removeListener:yt,removeAllListeners:mt,emit:gt,binding:s,cwd:f,chdir:l,umask:d,hrtime:p,platform:ot,release:ft,config:lt,uptime:v},Ot="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tt=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Et=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),At=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},Pt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},kt=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var u,a=e[Symbol.iterator]();!(r=(u=a.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(c){o=!0,i=c}finally{try{!r&&a["return"]&&a["return"]()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),xt=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},qt=y(function(e,t){!function(t,n){e.exports=n()}(Ot,function(){function e(e){return"function"==typeof e||"object"===("undefined"==typeof e?"undefined":St(e))&&null!==e}function t(e){return"function"==typeof e}function n(e){K=e}function r(e){W=e}function o(){return function(){return u(f)}}function i(){return"undefined"!=typeof G?function(){G(f)}:s()}function a(){var e=0,t=new V(f),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function c(){var e=new MessageChannel;return e.port1.onmessage=f,function(){return e.port2.postMessage(0)}}function s(){var e=setTimeout;return function(){return e(f,1)}}function f(){for(var e=0;e<Y;e+=2){var t=te[e],n=te[e+1];t(n),te[e]=void 0,te[e+1]=void 0}Y=0}function l(){try{var e=h,t=e("vertx");return G=t.runOnLoop||t.runOnContext,i()}catch(n){return s()}}function d(e,t){var n=arguments,r=this,o=new this.constructor(v);void 0===o[re]&&C(o);var i=r._state;return i?!function(){var e=n[i-1];W(function(){return q(i,o,e,r._result)})}():A(r,o,e,t),o}function p(e){var t=this;if(e&&"object"===("undefined"==typeof e?"undefined":St(e))&&e.constructor===t)return e;var n=new t(v);return O(n,e),n}function v(){}function y(){return new TypeError("You cannot resolve a promise with itself")}function m(){return new TypeError("A promises callback cannot return that same promise.")}function g(e){try{return e.then}catch(t){return ae.error=t,ae}}function b(e,t,n,r){try{e.call(t,n,r)}catch(o){return o}}function w(e,t,n){W(function(e){var r=!1,o=b(n,t,function(n){r||(r=!0,t!==n?O(e,n):T(e,n))},function(t){r||(r=!0,E(e,t))},"Settle: "+(e._label||" unknown promise"));!r&&o&&(r=!0,E(e,o))},e)}function _(e,t){t._state===ie?T(e,t._result):t._state===ue?E(e,t._result):A(t,void 0,function(t){return O(e,t)},function(t){return E(e,t)})}function j(e,n,r){n.constructor===e.constructor&&r===d&&n.constructor.resolve===p?_(e,n):r===ae?(E(e,ae.error),ae.error=null):void 0===r?T(e,n):t(r)?w(e,n,r):T(e,n)}function O(t,n){t===n?E(t,y()):e(n)?j(t,n,g(n)):T(t,n)}function S(e){e._onerror&&e._onerror(e._result),P(e)}function T(e,t){e._state===oe&&(e._result=t,e._state=ie,0!==e._subscribers.length&&W(P,e))}function E(e,t){e._state===oe&&(e._state=ue,e._result=t,W(S,e))}function A(e,t,n,r){var o=e._subscribers,i=o.length;e._onerror=null,o[i]=t,o[i+ie]=n,o[i+ue]=r,0===i&&e._state&&W(P,e)}function P(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,o=void 0,i=e._result,u=0;u<t.length;u+=3)r=t[u],o=t[u+n],r?q(n,r,o,i):o(i);e._subscribers.length=0}}function k(){this.error=null}function x(e,t){try{return e(t)}catch(n){return ce.error=n,ce}}function q(e,n,r,o){var i=t(r),u=void 0,a=void 0,c=void 0,s=void 0;if(i){if(u=x(r,o),u===ce?(s=!0,a=u.error,u.error=null):c=!0,n===u)return void E(n,m())}else u=o,c=!0;n._state!==oe||(i&&c?O(n,u):s?E(n,a):e===ie?T(n,u):e===ue&&E(n,u))}function I(e,t){try{t(function(t){O(e,t)},function(t){E(e,t)})}catch(n){E(e,n)}}function N(){return se++}function C(e){e[re]=se++,e._state=void 0,e._result=void 0,e._subscribers=[]}function R(e,t){this._instanceConstructor=e,this.promise=new e(v),this.promise[re]||C(this.promise),B(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?T(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&T(this.promise,this._result))):E(this.promise,M())}function M(){return new Error("Array Methods must be provided an Array")}function U(e){return new R(this,e).promise}function D(e){var t=this;return new t(B(e)?function(n,r){for(var o=e.length,i=0;i<o;i++)t.resolve(e[i]).then(n,r)}:function(e,t){return t(new TypeError("You must pass an array to race."))})}function L(e){var t=this,n=new t(v);return E(n,e),n}function J(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function F(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function H(e){this[re]=N(),this._result=this._state=void 0,this._subscribers=[],v!==e&&("function"!=typeof e&&J(),this instanceof H?I(this,e):F())}function X(){var e=void 0;if("undefined"!=typeof Ot)e=Ot;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=e.Promise;if(n){var r=null;try{r=Object.prototype.toString.call(n.resolve())}catch(t){}if("[object Promise]"===r&&!n.cast)return}e.Promise=H}var z=void 0;z=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var B=z,Y=0,G=void 0,K=void 0,W=function(e,t){te[Y]=e,te[Y+1]=t,Y+=2,2===Y&&(K?K(f):ne())},$="undefined"!=typeof window?window:void 0,Q=$||{},V=Q.MutationObserver||Q.WebKitMutationObserver,Z="undefined"==typeof self&&"undefined"!=typeof jt&&"[object process]"==={}.toString.call(jt),ee="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,te=new Array(1e3),ne=void 0;ne=Z?o():V?a():ee?c():void 0===$&&"function"==typeof h?l():s();var re=Math.random().toString(36).substring(16),oe=void 0,ie=1,ue=2,ae=new k,ce=new k,se=0;return R.prototype._enumerate=function(){for(var e=this.length,t=this._input,n=0;this._state===oe&&n<e;n++)this._eachEntry(t[n],n)},R.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===p){var o=g(e);if(o===d&&e._state!==oe)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(n===H){var i=new n(v);j(i,e,o),this._willSettleAt(i,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},R.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===oe&&(this._remaining--,e===ue?E(r,n):this._result[t]=n),0===this._remaining&&T(r,this._result)},R.prototype._willSettleAt=function(e,t){var n=this;A(e,void 0,function(e){return n._settledAt(ie,t,e)},function(e){return n._settledAt(ue,t,e)})},H.all=U,H.race=D,H.resolve=p,H.reject=L,H._setScheduler=n,H._setAsap=r,H._asap=W,H.prototype={constructor:H,then:d,"catch":function(e){return this.then(null,e)}},H.polyfill=X,H.Promise=H,H})}),It=(qt.polyfill(),"object"==("undefined"==typeof We?"undefined":St(We))&&We&&We.Object===Object&&We),Nt="object"==("undefined"==typeof self?"undefined":St(self))&&self&&self.Object===Object&&self,Ct=It||Nt||Function("return this")(),Rt=Ct.Symbol,Mt=Object.prototype,Ut=Mt.hasOwnProperty,Dt=Mt.toString,Lt=Rt?Rt.toStringTag:void 0,Jt=Object.prototype,Ft=Jt.toString,Ht="[object Null]",Xt="[object Undefined]",zt=Rt?Rt.toStringTag:void 0,Bt=w(Object.getPrototypeOf,Object),Yt="[object Object]",Gt=Function.prototype,Kt=Object.prototype,Wt=Gt.toString,$t=Kt.hasOwnProperty,Qt=Wt.call(Object);nt="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof We?We:"undefined"!=typeof module?module:Function("return this")();var Vt=O(nt),Zt={INIT:"@@redux/INIT"},en=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tn="set-option",nn="login",rn="login-successful",on="login-failed",un="logout",an="logout-successful",cn="save",sn="save-successful",fn="save-failed",ln="find-data",dn="find-data-successful",pn="get-data",vn="get-data-successful",hn="set-data",yn="set-data-successful",mn="set-data-failed",gn="remove-data",bn="remove-data-successful",wn="find-data-from-api",_n="find-data-from-api-successful",jn="find-data-from-api-failed",On="get-data-from-api",Sn="get-data-from-api-successful",Tn="get-data-from-api-failed",En="set-data-to-api",An="set-data-to-api-successful",Pn="set-data-to-api-failed",kn="remove-data-from-api",xn="remove-data-from-api-successful",qn="remove-data-from-api-failed",In="edit-active",Nn="edit-inactive",Cn="observe-query",Rn="function"==typeof fetch?fetch:function(e,t){return t=t||{},new Promise(function(n,r){function o(){var e,t=[],n=[],r={};return i.getAllResponseHeaders().replace(/^(.*?):\s*([\s\S]*?)$/gm,function(o,i,u){t.push(i=i.toLowerCase()),n.push([i,u]),e=r[i],r[i]=e?e+","+u:u}),{ok:1==(i.status/200|0),status:i.status,statusText:i.statusText,url:i.responseURL,clone:o,text:function(){return Promise.resolve(i.responseText)},json:function(){return Promise.resolve(i.responseText).then(JSON.parse)},xml:function(){return Promise.resolve(i.responseXML)},blob:function(){return Promise.resolve(new Blob([i.response]))},headers:{keys:function(){return t},entries:function(){return n},get:function(e){return r[e.toLowerCase()]},has:function(e){return e.toLowerCase()in r}}}}var i=new XMLHttpRequest;i.open(t.method||"get",e);for(var u in t.headers)i.setRequestHeader(u,t.headers[u]);i.withCredentials="include"==t.credentials,i.onload=function(){n(o())},i.onerror=r,i.send(t.body)})},Mn={get:function(e,t){return C(Pt({method:"GET"},t,{url:e}))},post:function(e,t){return R(Pt({method:"POST"},t,{url:e}))},put:function(e,t){return R(Pt({method:"PUT"},t,{url:e}))},"delete":function(e,t){return R(Pt({method:"DELETE"},t,{url:e}))}},Un="Invalid content: only type and data properties are allowed",Dn="_data",Ln="_queries",Jn=function(e){return{type:wn,query:e}},Fn=function(e,t){return{type:_n,query:e,response:t}},Hn=function(e,t){return{type:jn,query:e,response:t}},Xn=function(e){return{type:On,uid:e}},zn=function(e,t){return{type:Sn,uid:e,response:t}},Bn=function(e,t){return{type:Tn,uid:e,response:t}},Yn=function(e,t){return{type:En,uid:e,body:t}},Gn=function(e,t,n){return{type:An,uid:e,body:t,response:n}},Kn=function(e,t,n){return{type:Pn,uid:e,body:t,response:n}},Wn=function(e){return{type:kn,uid:e}},$n=function(e,t){return{type:xn,uid:e,response:t}},Qn=function(e,t){return{type:qn,uid:e,response:t}},Vn=le("get",function(e){return{uid:e}},[Xn,zn,Bn]),Zn=le("put",function(e,t){return{uid:e,body:t}},[Yn,Gn,Kn]),er=le("delete",function(e){return{uid:e}},[Wn,$n,Qn]),tr=le("get",function(e){return{query:e}},[Jn,Fn,Hn],!1),nr="https://api.simpla.io",rr=function(e){var t=void 0,n=void 0;n=function(e){var n=e.authEndpoint,r=e.project;return!(!n||!r)&&(Rn(n+"/projects/"+r+"/sessions",{method:"POST"}),t&&t.unobserve(),!0)},n(e.getState("config"))||(t=e.observeState("config",n))},or="simpla-token",ir="https://simpla.auth0.com/",ur="Could not remember login token. Are you in Private Mode?",ar="Could not load login token from storage. Are you in Private Mode?",cr="Could not logout. Are you in Private Mode?",sr="Invalid token",fr=function(e){Ne(e),e.observeState("token",Ie)},lr=Ce();lr.withExtraArgument=Ce;var dr,pr=function(e){return function(t){return e.indexOf(t)===-1}},vr=function(e){return function(t){return e!==t}},hr=!1,yr=A({hierarchy:Xe,content:ze}),mr=A((dr={},At(dr,Dn,yr),At(dr,Ln,De),At(dr,"authenticated",Re),At(dr,"config",Me),At(dr,"editable",Le),At(dr,"token",Be),At(dr,"save",Ke),dr));xe();var gr=new(function(){function e(){Tt(this,e);var t=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||P;this._store=S(mr,t(k(lr)))}return Et(e,[{key:"init",value:function(e){this._store.dispatch(x("project",e)),this._store.dispatch(x("authEndpoint",nr)),this._store.dispatch(x("dataEndpoint",nr+"/projects/"+e+"/content"))}},{key:"login",value:function(){return Q(this._store,L.apply(void 0,arguments),rn)}},{key:"logout",value:function(){return Q(this._store,H.apply(void 0,arguments),an)}},{key:"find",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.parent;return t.parent=oe(n),Promise.resolve().then(function(){return ce(n)}).then(function(){return Q(e._store,Se(t),dn)}).then(ae)}},{key:"get",value:function(e){
for(var t=this,n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i=oe(e);return Promise.resolve().then(function(){return ce(e)}).then(function(){return Q(t._store,Oe.apply(void 0,[i].concat(r)),vn)}).then(ue)}},{key:"set",value:function(e){for(var t=this,n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i=oe(e);return Promise.resolve().then(function(){return ce(e)}).then(function(){return Q(t._store,_e.apply(void 0,[i].concat(r)),yn)}).then(ue)}},{key:"remove",value:function(e){for(var t=this,n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i=oe(e);return Promise.resolve().then(function(){return ce(e)}).then(function(){return Q(t._store,je.apply(void 0,[i].concat(r)),bn)}).then(ue)}},{key:"observe",value:function(e){for(var t=this,n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i=r.pop(),u=oe(e),a=void 0,c=void 0;if(!u)throw new Error("Observe must be given a valid path");return ce(e),a=[Dn,"content",u],c=function(){return t.get(e).then(i)},G(this._store).observe(a,c)}},{key:"observeQuery",value:function(e,t){var n=this,r=void 0,o=void 0,i=void 0;return e.parent=oe(e.parent),r=ee(e),o=[Ln,r,"matches"],this._store.dispatch(Te(e)),i=function(e){return t(ae(B(e,n.getState())))},G(this._store).observe(o,i)}},{key:"save",value:function(){return Q(this._store,ke.apply(void 0,arguments),sn)}},{key:"editable",value:function(e){this._store.dispatch(e?q():I())}},{key:"getState",value:function(e){var t=this._store.getState();return e?X(e,t):t}},{key:"observeState",value:function(){var e;return(e=G(this._store)).observe.apply(e,arguments)}}]),e}()),br=[rr,fr];return br.forEach(function(e){return e(gr)}),gr});